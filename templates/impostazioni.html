{% extends "base.html" %}

{% block title %}Impostazioni - B.O.M.{% endblock %}

{% block content %}
<div class="settings-container">
    <div class="settings-header">
        <h1>Impostazioni</h1>
        <p>Gestisci le tue preferenze</p>
    </div>

    <div class="settings-section">
        <h2>Preferenze Generali</h2>
        <div class="mb-3">
            <label class="form-label">Tema</label>
            <select class="form-select" id="theme-select">
                <option value="light">Chiaro</option>
                <option value="dark">Scuro</option>
                <option value="blue">Blu</option>
                <option value="green">Verde</option>
                <option value="pink">Rosa</option>
                <option value="sunset">Sunset</option>
                <option value="aqua">Aqua</option>
                <option value="forest">Forest</option>
                <option value="lavender">Lavender</option>
                <option value="midnight">Midnight</option>
                <option value="solar">Solar</option>
                <option value="coffee">Coffee</option>
                <option value="nord">Nord</option>
                <option value="desert">Deserto</option>
                <option value="grape">Uva</option>
                <option value="ocean">Oceano</option>
                <option value="nebula">Nebulosa</option>
                <option value="stone">Pietra</option>
            </select>
        </div>
    </div>

    <div class="settings-section">
        <h2>Notifiche</h2>
        <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" id="emailNotifications">
            <label class="form-check-label" for="emailNotifications">
                Notifiche email
            </label>
        </div>
    </div>
</div>
{% endblock %}
{% block script_extra %}
<script>
    async function caricaTemaUtente() {
        const res = await fetch('/impostazioni/api/tema');
        const data = await res.json();
        const tema = data.tema || 'light';
        document.getElementById('theme-select').value = tema;
        document.documentElement.setAttribute('data-theme', tema);
        localStorage.setItem('theme', tema);
    }

    async function salvaTemaUtente(tema) {
        await fetch('/impostazioni/api/tema', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ tema })
        });
        document.documentElement.setAttribute('data-theme', tema);
        localStorage.setItem('theme', tema);
    }

    document.addEventListener('DOMContentLoaded', function () {
        caricaTemaUtente();
        document.getElementById('theme-select').addEventListener('change', function (e) {
            salvaTemaUtente(e.target.value);
        });
    });
</script>
{% endblock %}