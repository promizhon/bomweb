{% extends "base.html" %}

{% block title %}Dashboard - B.O.M.{% endblock %}

{% block content %}


<div class="dashboard-header">
    <h1>BEI Order Management</h1>
    <p>B.O.M.</p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(52, 152, 219, 0.1); color: var(--accent);">
            <i class="fas fa-box"></i>
        </div>
        <div class="stat-value">1,234</div>
        <div class="stat-label">Prodotti Totali</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(46, 204, 113, 0.1); color: var(--success);">
            <i class="fas fa-shopping-cart"></i>
        </div>
        <div class="stat-value">56</div>
        <div class="stat-label">Ordini Attivi</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon" style="background: rgba(155, 89, 182, 0.1); color: #9B59B6;">
            <i class="fas fa-warehouse"></i>
        </div>
        <div class="stat-value">5</div>
        <div class="stat-label">Magazzini</div>
    </div>
</div>

<!-- CHAT + UTENTI -->
<div class="chat-container" style="display: flex; gap: 2rem; margin-top: 2rem; align-items: stretch; height: 500px;">
    
    <!-- Chat Box -->
    <div class="chat-box" style="flex: 3; min-width: 300px; background: var(--bg-secondary); border-radius: 15px; padding: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #BDD70F; display: flex; flex-direction: column;">

        <!-- Tabs interni -->
        <div class="chat-tabs" style="display: flex; gap: 1rem; margin-bottom: 1rem;">
            <button class="chat-tab active" data-tab="pubblico" style="padding: 6px 12px; border-radius: 8px; border: 1px solid #BDD70F; background: var(--bg-primary); cursor: pointer;">üè¢ Chat Aziendale</button>
            <button class="chat-tab" data-tab="gruppo" style="padding: 6px 12px; border-radius: 8px; border: 1px solid #BDD70F; background: var(--bg-primary); cursor: pointer;">üë• Chat Gruppi</button>
            <button class="chat-tab" data-tab="privato" style="padding: 6px 12px; border-radius: 8px; border: 1px solid #BDD70F; background: var(--bg-primary); cursor: pointer;">üí¨ Chat Privata</button>
        </div>

        <!-- Contenitore tab chat -->
        <div class="chat-panes" style="flex: 1; display: flex; flex-direction: column;">

            <!-- Tab: Azienda -->
            <div id="chat-pane-pubblico" class="chat-pane active" style="flex: 1; display: flex; flex-direction: column;">
                <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 0.8rem; background: var(--bg-primary); border-radius: 10px; margin-bottom: 0.8rem; border: 1px solid #BDD70F;"></div>
                <form id="chat-form" style="display: flex; gap: 0.5rem;">
                    <input type="text" id="chat-input" placeholder="Scrivi un messaggio..." style="flex: 1; padding: 8px 16px; border-radius: 20px; border: 2px solid #3498DB; background: var(--bg-primary); color: var(--text-color); font-size: 0.9rem;">
                    <button type="submit" style="padding: 8px 20px; border-radius: 20px; border: none; background: #3498DB; color: black; font-weight: 500;">
                        <i class="fas fa-paper-plane"></i> Invia
                    </button>
                </form>
            </div>

            <!-- Tab: Gruppi -->
            <div id="chat-pane-gruppo" class="chat-pane" style="display: none; flex-direction: column; flex: 1;">
                <div id="chat-messages-gruppo" style="flex: 1; overflow-y: auto; padding: 0.8rem; background: var(--bg-primary); border-radius: 10px; margin-bottom: 0.8rem; border: 1px solid #BDD70F;"></div>
                <form id="chat-form-gruppo" style="display: flex; gap: 0.5rem;">
                    <input type="text" id="chat-input-gruppo" placeholder="Messaggio al gruppo..." style="flex: 1; padding: 8px 16px; border-radius: 20px; border: 2px solid #3498DB;">
                    <button type="submit" style="padding: 8px 20px; border-radius: 20px; border: none; background: #3498DB; color: black; font-weight: 500;">
                        <i class="fas fa-paper-plane"></i> Invia
                    </button>
                </form>
            </div>

            <!-- Tab: Privato -->
            <div id="chat-pane-privato" class="chat-pane" style="display: none; flex-direction: column; flex: 1;">
                <div style="margin-bottom: 0.5rem;">
                    <label for="utente-dest" style="font-weight: 500;">Invia a:</label>
                    <select id="utente-dest" style="margin-left: 0.5rem; padding: 6px 10px; border-radius: 8px; border: 1px solid #3498DB;"></select>
                </div>
                <div id="chat-messages-privato" style="flex: 1; overflow-y: auto; padding: 0.8rem; background: var(--bg-primary); border-radius: 10px; margin-bottom: 0.8rem; border: 1px solid #BDD70F;"></div>
                <form id="chat-form-privato" style="display: flex; gap: 0.5rem;">
                    <input type="text" id="chat-input-privato" placeholder="Messaggio privato..." style="flex: 1; padding: 8px 16px; border-radius: 20px; border: 2px solid #3498DB;">
                    <button type="submit" style="padding: 8px 20px; border-radius: 20px; border: none; background: #3498DB; color: black; font-weight: 500;">
                        <i class="fas fa-paper-plane"></i> Invia
                    </button>
                </form>
            </div>

        </div>
    </div>

    <!-- Online Users -->
    <div class="user-list" style="flex: 1; min-width: 250px; background: var(--bg-secondary); border-radius: 15px; padding: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #BDD70F; overflow-y: auto;">
        <h4 style="margin-bottom: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 0.8rem;">
            <i class="fas fa-user-friends" style="color: #3498DB; font-size: 1.2rem;"></i>
            <span style="background: linear-gradient(45deg, #3498DB, #5DADE2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Utenti Online</span>
        </h4>
        <ul id="online-users" style="list-style: none; padding: 0; margin: 0;">
            {% for utente in utenti_connessi %}
            <li style="padding: 0.6rem; margin-bottom: 0.4rem; background: var(--bg-primary); border-radius: 10px; display: flex; align-items: center; gap: 0.8rem; border: 1px solid #BDD70F;">
                <div style="width: 30px; height: 30px; background: #BDD70F; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: black;">
                    {{ utente.login[0]|upper }}
                </div>
                <span style="font-weight: 500;">{{ utente.login }}</span>
                <span style="margin-left: auto; width: 6px; height: 6px; background: #2ecc71; border-radius: 50%;"></span>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>


{% endblock %}
